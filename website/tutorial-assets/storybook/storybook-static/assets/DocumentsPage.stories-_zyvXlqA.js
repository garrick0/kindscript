import{r as n,j as e}from"./iframe-D5evrB1t.js";import{u as G,S as z}from"./ServiceProvider-cR3iPtCj.js";import{u as J,d as K,a as Q}from"./overrides-CIz7JqZY.js";import{n as X}from"./navigation-B4QW0cIQ.js";import{E as W}from"./ErrorBoundary-DsfJsOaU.js";import{S as v,a as Y}from"./Skeleton-BToTCHHV.js";import{S as Z}from"./search-DrQCx2FU.js";import{F as ee,S as $}from"./star-C9rq_WCT.js";import{P as te,C as se,a as ae}from"./plus-BIwiTHae.js";import{F as q}from"./file-text-BR3Iz2MY.js";import{U as re}from"./users-CaUii9q0.js";import{S as R,T as ne}from"./trash-2-CKY6oqXC.js";import{c as le}from"./createLucideIcon-CYL-vWIR.js";import"./preload-helper-D9Z9MdNV.js";import"./_interop_require_wildcard-DNKDR2gK.js";import"./triangle-alert-Bin-rNB-.js";import"./house-C64cIi8I.js";import"./cn-BQ1woUC9.js";function oe(x){const{documents:s}=G(),[w,y]=n.useState([]),[p,g]=n.useState(!0),[_,h]=n.useState(null),[u,c]=n.useState(x||{}),[o,d]=n.useState(null),[j,N]=n.useState([]),[b,D]=n.useState([]),l=n.useCallback(async()=>{if(s)try{g(!0),h(null);const a=await s.getDocuments(u);y(a)}catch(a){h(a),console.error("Failed to fetch documents:",a)}finally{g(!1)}},[s,u]);n.useEffect(()=>{l()},[l]);const L=n.useCallback(async a=>{if(!a){d(null),N([]),D([]);return}if(s)try{const r=await s.getDocument(a);d(r)}catch(r){console.error("Failed to select document:",r),h(r)}},[s]),O=n.useCallback(async a=>{if(!s)throw new Error("Document service not available");const r={title:a.title||"Untitled",content:a.content||"",status:a.status,authoritative:a.authoritative,metadata:a.metadata},m=await s.createDocument(r);return await l(),m},[s,l]),U=n.useCallback(async(a,r)=>{if(!s)throw new Error("Document service not available");const m=await s.updateDocument(a,r);return await l(),o?.id===a&&d(m),m},[s,l,o]),S=n.useCallback(async a=>{if(!s)throw new Error("Document service not available");await s.deleteDocument(a),await l(),o?.id===a&&d(null)},[s,l,o]),C=n.useCallback(async a=>{if(!s)throw new Error("Document service not available");const r=await s.publishDocument(a);return await l(),o?.id===a&&d(r),r},[s,l,o]),V=n.useCallback(async a=>{if(!s)throw new Error("Document service not available");const r=await s.archiveDocument(a);return await l(),o?.id===a&&d(r),r},[s,l,o]),H=n.useCallback(async a=>{if(s)try{const r=await s.getVersions(a);N(r)}catch(r){console.error("Failed to load versions:",r),h(r)}},[s]),M=n.useCallback(async(a,r)=>{if(!s)throw new Error("Document service not available");const m=await s.restoreVersion(a,r);return await l(),o?.id===a&&d(m),m},[s,l,o]),t=n.useCallback(async a=>{if(s)try{const r=await s.getCollaborators(a);D(r)}catch(r){console.error("Failed to load collaborators:",r),h(r)}},[s]),i=n.useCallback(async(a,r,m)=>{if(!s)throw new Error("Document service not available");await s.addCollaborator(a,r,m),await t(a)},[s,t]),f=n.useCallback(async(a,r)=>{if(!s)throw new Error("Document service not available");await s.removeCollaborator(a,r),await t(a)},[s,t]);return{documents:w,loading:p,error:_,filters:u,selectedDocument:o,versions:j,collaborators:b,actions:{setFilters:c,selectDocument:L,createDocument:O,updateDocument:U,deleteDocument:S,publishDocument:C,archiveDocument:V,loadVersions:H,restoreVersion:M,loadCollaborators:t,addCollaborator:i,removeCollaborator:f,refetch:l}}}/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],ie=le("archive",ce);function B({userId:x,initialFilters:s}){const w=X.useRouter(),{user:y,loading:p}=J(),{documents:g,loading:_,error:h,filters:u,actions:c}=oe(s),[o,d]=n.useState(""),[j,N]=n.useState(!1),[b,D]=n.useState("all"),[l,L]=n.useState(!1);n.useEffect(()=>{!p&&!y&&!x&&w.push("/auth/signin")},[p,y,x,w]);const O=t=>{t.preventDefault(),c.setFilters({...u,search:o})},U=t=>{if(D(t),t==="all"){const{status:i,...f}=u;c.setFilters(f)}else c.setFilters({...u,status:t})},S=t=>{if(L(t),t)c.setFilters({...u,authoritative:!0});else{const{authoritative:i,...f}=u;c.setFilters(f)}},C=async()=>{try{const t=await c.createDocument({title:"New Document",content:`# New Document

Start writing here...`,status:"draft"});c.selectDocument(t.id)}catch(t){console.error("Failed to create document:",t)}},V=async t=>{if(confirm("Are you sure you want to delete this document?"))try{await c.deleteDocument(t)}catch(i){console.error("Failed to delete document:",i)}},H=t=>{switch(t){case"draft":return e.jsx(R,{className:"h-4 w-4"});case"review":return e.jsx(ae,{className:"h-4 w-4"});case"published":return e.jsx(se,{className:"h-4 w-4"});case"archived":return e.jsx(ie,{className:"h-4 w-4"});default:return e.jsx(q,{className:"h-4 w-4"})}},M=t=>{switch(t){case"draft":return"text-gray-500";case"review":return"text-yellow-500";case"published":return"text-green-500";case"archived":return"text-red-500";default:return"text-gray-400"}};return p||_?e.jsx(W,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(v,{variant:"text",width:"200px",height:36,className:"mb-2"}),e.jsx(v,{variant:"text",width:"400px",height:24})]}),e.jsx("div",{className:"bg-white shadow rounded-lg mb-6 p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(v,{variant:"rounded",height:40,className:"flex-1"}),e.jsx(v,{variant:"rounded",width:100,height:40}),e.jsx(v,{variant:"rounded",width:140,height:40})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(t=>e.jsx(Y,{},t))})]})})}):h?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading documents: ",h.message]}),e.jsx("button",{onClick:()=>c.refetch(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):e.jsx(W,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Documents"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your authoritative documents and content"})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-6 p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("form",{onSubmit:O,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:o,onChange:t=>d(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs("button",{onClick:()=>N(!j),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Filters",(b!=="all"||l)&&e.jsxs("span",{className:"bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full text-xs",children:[b!=="all"?1:0," + ",l?1:0]})]}),e.jsxs("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"New Document"]})]}),j&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("div",{className:"flex gap-2",children:["all","draft","review","published","archived"].map(t=>e.jsx("button",{onClick:()=>U(t),className:`px-3 py-1 rounded-full text-sm ${b===t?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S(!1),className:`px-3 py-1 rounded-full text-sm ${l?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-blue-100 text-blue-600"}`,children:"All Documents"}),e.jsxs("button",{onClick:()=>S(!0),className:`px-3 py-1 rounded-full text-sm flex items-center gap-1 ${l?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx($,{className:"h-3 w-3"}),"Authoritative Only"]})]})]})]})})]}),g.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-8 text-center",children:[e.jsx(q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by creating your first document"}),e.jsx("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Document"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(t=>e.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>c.selectDocument(t.id),children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[H(t.status),e.jsx("span",{className:`text-sm ${M(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]}),t.authoritative&&e.jsx($,{className:"h-5 w-5 text-yellow-500 fill-current"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),e.jsxs("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:[t.content.substring(0,150),"..."]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:t.metadata?.author||"Unknown"}),e.jsx("span",{children:new Date(t.updatedAt).toLocaleDateString()})]}),t.metadata?.tags&&t.metadata.tags.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:t.metadata.tags.slice(0,3).map(i=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs",children:i},i))})]}),e.jsxs("div",{className:"border-t px-6 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.collaborators&&t.collaborators.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs",children:t.collaborators.length})]}),e.jsx("span",{className:"text-xs text-gray-500",children:t.metadata?.version||"v1.0.0"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),c.selectDocument(t.id)},className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(R,{className:"h-4 w-4 text-gray-500"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),V(t.id)},className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ne,{className:"h-4 w-4 text-gray-500"})})]})]})]},t.id))})]})})})}B.__docgenInfo={description:"",methods:[],displayName:"DocumentsPage",props:{userId:{required:!1,tsType:{name:"string"},description:""},initialFilters:{required:!1,tsType:{name:"DocumentFilters"},description:""}}};const Fe={title:"Design System/Pages/Documents/v1.0.0",component:B,parameters:{layout:"fullscreen"},decorators:[x=>e.jsx(z,{useMocks:!0,children:e.jsx(x,{})})]},k={args:{userId:"user-123"}},F={args:{userId:"user-123",initialFilters:{status:"published",authoritative:!0}}},E={parameters:{msw:{handlers:K(3e3)}},args:{userId:"user-123"}},I={parameters:{msw:{handlers:Q.empty}},args:{userId:"user-123"}},A={args:{userId:"user-123",initialFilters:{authoritative:!0}}},P={args:{userId:"user-123",initialFilters:{status:"draft"}}},T={args:{userId:"user-123",initialFilters:{search:"architecture"}}};k.parameters={...k.parameters,docs:{...k.parameters?.docs,source:{originalSource:`{
  args: {
    userId: 'user-123'
  }
}`,...k.parameters?.docs?.source}}};F.parameters={...F.parameters,docs:{...F.parameters?.docs,source:{originalSource:`{
  args: {
    userId: 'user-123',
    initialFilters: {
      status: 'published',
      authoritative: true
    }
  }
}`,...F.parameters?.docs?.source}}};E.parameters={...E.parameters,docs:{...E.parameters?.docs,source:{originalSource:`{
  parameters: {
    msw: {
      handlers: delayHandlers(3000)
    }
  },
  args: {
    userId: 'user-123'
  }
}`,...E.parameters?.docs?.source}}};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  parameters: {
    msw: {
      handlers: documentHandlers.empty
    }
  },
  args: {
    userId: 'user-123'
  }
}`,...I.parameters?.docs?.source}}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`{
  args: {
    userId: 'user-123',
    initialFilters: {
      authoritative: true
    }
  }
}`,...A.parameters?.docs?.source}}};P.parameters={...P.parameters,docs:{...P.parameters?.docs,source:{originalSource:`{
  args: {
    userId: 'user-123',
    initialFilters: {
      status: 'draft'
    }
  }
}`,...P.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  args: {
    userId: 'user-123',
    initialFilters: {
      search: 'architecture'
    }
  }
}`,...T.parameters?.docs?.source}}};const Ee=["Default","WithFilters","LoadingState","EmptyState","AuthoritativeOnly","DraftDocuments","WithSearch"];export{A as AuthoritativeOnly,k as Default,P as DraftDocuments,I as EmptyState,E as LoadingState,F as WithFilters,T as WithSearch,Ee as __namedExportsOrder,Fe as default};
